services:
  mediamtx:
    image: bluenviron/mediamtx:latest
    restart: unless-stopped
    # WebRTC is extremely sensitive to NAT and advertised IPs; host networking keeps
    # ICE candidates correct on a headless Ubuntu VM.
    network_mode: host
    volumes:
      - ./mediamtx/mediamtx.yml:/mediamtx.yml:ro

  backend:
    build:
      context: ./backend
    restart: unless-stopped
    network_mode: host
    depends_on:
      - mediamtx
