###############################################
# MediaMTX minimal config for OBS ingest + WebRTC playback.
# - OBS publishes via RTMP (low friction).
# - Browsers play via WebRTC (near-live latency).
#
# Default path name used by this repo: "obs"
#   OBS RTMP URL:   rtmp://<VM_IP>:1935/obs
#   WebRTC player:  http://<VM_IP>:8889/obs
#
# Ports used (host network):
# - 1935/tcp RTMP ingest
# - 8889/tcp WebRTC HTTP (player + WHEP)
# - 8189/udp WebRTC ICE / media
# - 9997/tcp Control API (used by dashboard status)

logLevel: info
logDestinations: [stdout]

# Disable protocols we don't need for the MVP dashboard.
rtsp: no
hls: no
srt: no

rtmp: yes
rtmpAddress: :1935

webrtc: yes
webrtcAddress: :8889
webrtcEncryption: no
webrtcAllowOrigins: ['*']
# fixed UDP port makes firewalling easy
webrtcLocalUDPAddress: :8189
# Optional TCP fallback for networks that block UDP.
webrtcLocalTCPAddress: :8189

# Avoid advertising docker bridge / loopback addresses.
# Pick the VM LAN interface IP(s) only. On this VM it's typically `enp0s3`.
webrtcIPsFromInterfaces: yes
webrtcIPsFromInterfacesList: [enp0s3]

# If the server is in a VM/container/NAT, explicitly advertise the LAN IP that clients use.
webrtcAdditionalHosts: [192.168.50.199]

api: yes
apiAddress: :9997
apiAllowOrigins: ['*']

paths:
  # Supports the "Server: rtmp://<VM_IP>:1935/live" + "Stream key: stream" OBS format.
  # This shows up as path "live/stream" inside MediaMTX.
  live/stream: {}

  # Optional alternate: "Server: rtmp://<VM_IP>:1935/obs" and empty stream key.
  obs: {}
